<?xml version="1.0" encoding="UTF-8"?>
 
<databaseChangeLog 
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">
    <changeSet author="SemenetsA" id="pregnancycdssmodule-2015-11-v-000" runAlways="true" dbms="mysql">
        <sql>SET FOREIGN_KEY_CHECKS=0</sql>
    </changeSet>
    <changeSet id="pregnancycdssmodule-2015-11-v-001" author="SemenetsA" dbms="mysql">
        <createTable tableName="form_pregnancycdss_diseases">
            <column name="diseases_id" type="integer" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="dis_name" type="varchar(100)" />
            <column name="dis_notes" type="varchar(255)" />
            <column name="dis_icd10" type="varchar(255)" />
            <column name="p_value" type="float" defaultValue="0"/>
        </createTable>
        <rollback>
            <dropTable tableName="form_pregnancycdss_diseases"/>
        </rollback>
    </changeSet>
    <changeSet id="pregnancycdssmodule-2015-11-v-002" author="SemenetsA" dbms="mysql">
        <sql>
            INSERT INTO `form_pregnancycdss_diseases` (`diseases_id`, `dis_name`, `dis_notes`, `dis_icd10`, `p_value`) VALUES
            (1, 'Своєчасні роди', NULL, NULL, 0.5),
            (2, 'Передчасні роди', NULL, NULL, 0.5)
        </sql>
    </changeSet>
    <changeSet id="pregnancycdssmodule-2015-11-v-003" author="SemenetsA" dbms="mysql">
        <createTable tableName="form_pregnancycdss_sympt_category">
            <column name="sympt_cat_id" type="integer" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="cat_name" type="varchar(100)" />
            <column name="cat_notes" type="varchar(150)" />
            <column name="is_selected" type="integer" defaultValue="1"/>
        </createTable>
        <rollback>
            <dropTable tableName="form_pregnancycdss_sympt_category"/>
        </rollback>
    </changeSet>
    <changeSet id="pregnancycdssmodule-2015-11-v-004" author="SemenetsA" dbms="mysql">
        <sql>
            INSERT INTO `form_pregnancycdss_sympt_category` (`sympt_cat_id`, `cat_name`, `cat_notes`, `is_selected`) VALUES
            (1, 'Анкетні дані вагітної', NULL, 1),
            (2, 'Стан при поступленні в стаціонар', NULL, 1),
            (3, 'Перебіг попередніх пологів', NULL, 1),
            (4, 'Анамнез вагітної', NULL, 1),
            (5, 'Статеве життя та гінекологічні захворювання', NULL, 1),
            (6, 'Ускладнення цієї вагітності', NULL, 1),
            (7, 'Результати обстеження', NULL, 1)
        </sql>
    </changeSet>
    <changeSet id="pregnancycdssmodule-2015-11-v-005" author="SemenetsA" dbms="mysql">
        <createTable tableName="form_pregnancycdss_symptoms">
            <column name="sympt_id" type="integer" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="sympt_name" type="varchar(50)" />
            <column name="sympt_notes" type="varchar(100)" defaultValue="null" />
            <column name="id_order" type="integer" defaultValue="0" />
            <column name="id_category" type="integer" defaultValue="1" />                        
            <column name="is_multi" type="integer" defaultValue="0" />
            <column name="is_selected" type="integer" defaultValue="1" />
        </createTable>
        <createIndex indexName="symptoms_symptomsid_category_ndx"
             tableName="form_pregnancycdss_symptoms">
            <column name="id_category" type="integer"/>
        </createIndex>
        <addForeignKeyConstraint constraintName="form_symptoms_ibfk_1"
        baseTableName="form_pregnancycdss_symptoms"
        baseColumnNames="id_category"
        onDelete="SET NULL"
        onUpdate="CASCADE"
        referencedTableName="form_pregnancycdss_sympt_category"
        referencedColumnNames="sympt_cat_id" />
        <rollback>
            <dropForeignKeyConstraint baseTableName="form_pregnancycdss_symptoms" constraintName="form_symptoms_ibfk_1"/>
            <dropTable tableName="form_pregnancycdss_symptoms"/>
        </rollback>
    </changeSet>
    <changeSet id="pregnancycdssmodule-2015-11-v-006" author="SemenetsA" dbms="mysql">
        <sql>
            INSERT INTO `form_pregnancycdss_symptoms` (`sympt_id`, `sympt_name`, `sympt_notes`, `id_order`, `id_category`, `is_multi`) VALUES
            (1, '1.1. Вік жінки', NULL, 1, 1, 0),
            (2, '1.2. Сезон року', NULL, 2, 1, 0),
            (3, '1.3. Адреса проживання', NULL, 3, 1, 0),
            (4, '1.4. Реєстрація шлюбу', NULL, 4, 1, 0),
            (5, '1.5. Вид роботи', NULL, 5, 1, 0),
            (6, '1.6. Шкідливості роботи', NULL, 6, 1, 0),
            (7, '1.7. Спадковість', NULL, 7, 1, 0),
            (8, '1.8. Шкідливі звички', NULL, 8, 1, 0),
            (9, '1.9. Фізична активність', NULL, 9, 1, 0),
            (10, '1.10. Взята на облік в ЖК', NULL, 10, 1, 0),
            (12, '2.1. Ріст жінки', NULL, 11, 2, 0),
            (13, '2.2. Вага жінки', NULL, 12, 2, 0),
            (14, '2.3. Котра вагітність', NULL, 13, 2, 0),
            (15, '2.4. Котрі пологи', NULL, 14, 2, 0),
            (16, '2.5. Розміри тазу', NULL, 15, 2, 0),
            (17, '2.6. Положення плоду', NULL, 16, 2, 0),
            (18, '2.7. Серцебиття плоду', NULL, 17, 2, 0),
            (19, '2.8. Передлежача частина', NULL, 18, 2, 0),
            (20, '2.9. Очікувана маса плоду', NULL, 19, 2, 0),
            (21, '3.1. Води відійшли', NULL, 20, 3, 0),
            (22, '3.2. Якість вод', NULL, 21, 3, 0),
            (23, '3.3. Кількість вод', NULL, 22, 3, 0),
            (24, '3.4. Безводний період', NULL, 23, 3, 0),
            (25, '3.5. Пологова діяльність', NULL, 24, 3, 0),
            (26, '3.6. Дитина народилась', NULL, 25, 3, 0),
            (27, '3.7. Скільки дітей', NULL, 26, 3, 0),
            (28, '3.8. Стать дитини', NULL, 27, 3, 0),
            (29, '3.9. Стан дитини', NULL, 28, 3, 0),
            (30, '3.10. Послід виділився', NULL, 29, 3, 0),
            (31, '3.11. Дитяче місце', NULL, 30, 3, 0),
            (32, '3.12. Крововтрата', NULL, 31, 3, 0),
            (33, '3.13. Післяродові розриви геніталій', NULL, 32, 3, 0),
            (34, '4.1. Загальні захворювання', NULL, 33, 4, 0),
            (35, '4.2. Інфекції', NULL, 34, 4, 0),
            (36, '4.3. Анамнез чоловіка', NULL, 35, 4, 0),
            (37, '4.4. Менархе', NULL, 36, 4, 0),
            (38, '4.5. Менструації встановились', NULL, 37, 4, 0),
            (39, '4.6. Менструації болючі', NULL, 38, 4, 0),
            (40, '4.7. Регулярність менструацій', NULL, 39, 4, 0),
            (41, '4.8. Тривалість менструацій', NULL, 40, 4, 0),
            (42, '4.9. Менструальний цикл', NULL, 41, 4, 0),
            (43, '4.10. Стан під час менструацій', NULL, 42, 4, 0),
            (44, '4.11 Працездатність під час менструацій', NULL, 43, 4, 0),
            (45, '4.12. Білі між менструаціями', NULL, 44, 4, 0),
            (46, '5.1. Статеве життя', NULL, 45, 5, 0),
            (47, '5.2. Аборти', NULL, 46, 5, 0),
            (48, '5.3. Гінекологічні захворювання', NULL, 47, 5, 0),
            (49, '5.4. Болі під час хвороб', NULL, 48, 5, 0),
            (50, '5.5. Локалізація болю', NULL, 49, 5, 0),
            (51, '5.6. Характер болю', NULL, 50, 5, 0),
            (52, '5.7. Періодичність болю', NULL, 51, 5, 0),
            (53, '5.8. Інтенсивність болю', NULL, 52, 5, 0),
            (54, '6.1. Переривання вагітності', NULL, 53, 6, 0),
            (55, '6.2. Стан плода', NULL, 54, 6, 0),
            (56, '6.3. Інферкції', NULL, 55, 6, 1),
            (57, '6.6. Гестози', NULL, 58, 6, 0),
            (58, '7.1. Кількість виділень', NULL, 59, 7, 0),
            (59, '7.2. Колір виділень', NULL, 60, 7, 0),
            (60, '7.3. Характер виділень', NULL, 61, 7, 0),
            (61, '7.4. Запах виділень', NULL, 62, 7, 0),
            (62, '7.5. Стан шийки матки', NULL, 63, 7, 0),
            (63, '7.6. Стан слизової шийки', NULL, 64, 7, 0),
            (64, '7.7. Матка і термін вагітності', NULL, 65, 7, 0),
            (65, '7.8. Група крові', NULL, 66, 7, 0),
            (66, '7.9. Резус фактор', NULL, 67, 7, 0),
            (67, '7.10. Титр антитіл', NULL, 68, 7, 0),
            (68, '7.11. Результати УЗД (плід)', NULL, 69, 7, 0),
            (69, '7.12. Результати УЗД (води)', NULL, 70, 7, 0),
            (70, '7.13. Результати УЗД (плацента)', NULL, 71, 7, 0),
            (71, '6.4. Явища гострого процесу', NULL, 56, 6, 1),
            (72, '6.5. Ознаки реактивації', NULL, 57, 6, 1)
        </sql>
    </changeSet>
    <changeSet id="pregnancycdssmodule-2015-11-v-011" author="SemenetsA" dbms="mysql">
        <sql>
            CREATE TABLE IF NOT EXISTS `form_pregnancycdss_patient_exam` (
            `exam_id` int(11) NOT NULL AUTO_INCREMENT,
            `exam_date` datetime default NULL,
            `id_patient` int(11) DEFAULT '0',
            `id_examuser` int(11) DEFAULT NULL,
            `groupname` varchar(255) DEFAULT NULL,
            `authorized` int(11) DEFAULT NULL,
            `id_activity` int(11) DEFAULT NULL,
            `id_encounter` int(11) DEFAULT NULL,
            `id_createuser` int(11) DEFAULT NULL,
            `createdate` datetime DEFAULT NULL,
            `is_firstpregnancy` tinyint(4) DEFAULT NULL,
            `expect_disease` varchar(255) DEFAULT NULL,
            `diseases` text CHARACTER SET utf8 COLLATE utf8_unicode_ci DEFAULT NULL,
            `id_finaldisease` int(11) DEFAULT '0',
            `finaldisease` varchar(255) DEFAULT NULL,
            `finaldisease_icd10` varchar(255) DEFAULT NULL,
            `id_decisiontree_decease` int(11) DEFAULT NULL,
            `diseases_tree` text CHARACTER SET utf8 COLLATE utf8_unicode_ci DEFAULT NULL,
            `decisiontree_img` text CHARACTER SET utf8 COLLATE utf8_unicode_ci DEFAULT NULL,
            `uuid` varchar(38) NOT NULL,
            PRIMARY KEY (`exam_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci AUTO_INCREMENT=1
        </sql>
        <rollback>
            <dropTable tableName="form_pregnancycdss_patient_exam"/>
        </rollback>
    </changeSet>
    <changeSet author="SemenetsA" id="pregnancycdssmodule-2015-11-v-100" runAlways="true" dbms="mysql">
        <sql>SET FOREIGN_KEY_CHECKS=1</sql>
    </changeSet>
</databaseChangeLog>